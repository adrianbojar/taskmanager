{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
  <h1>Dashboard</h1>

  <p class="muted">
    Zalogowany jako: <b>{{ user.email }}</b> â€¢ Rola: <b>{{ user.role }}</b>
  </p>

  <hr>

  <h2>Dodaj notatkÄ™</h2>
  <form method="post" action="{{ url_for('notes.add_note') }}" class="card">
    <label>TreÅ›Ä‡ (max 500 znakÃ³w)</label>
    <textarea name="content" rows="3" maxlength="500" required placeholder="Wpisz treÅ›Ä‡ notatki..."></textarea>

    <label>Kategoria</label>
    <select name="category" required>
      <option value="Praca">Praca</option>
      <option value="Studia">Studia</option>
    </select>

    <div class="actions">
      <button class="btn btn--primary" type="submit">Dodaj</button>
    </div>
  </form>

  <h2 style="margin-top: 18px;">Twoje notatki</h2>

  {% if notes %}
    <div class="notes">
      {% for note in notes %}
        <div class="note {% if note.is_done %}note--done{% endif %}">
          <div class="note-left">
            <form method="post" action="{{ url_for('notes.toggle_done', note_id=note.id) }}">
              <button class="check" type="submit" title="ZmieÅ„ status">
                {% if note.is_done %}âœ“{% else %}â—‹{% endif %}
              </button>
            </form>

            <div class="note-content">
              <div class="inline" style="margin-bottom:6px;">
                <b>{{ note.category }}</b>
                <span class="{{ note.presenter.badge_class }}">{{ note.presenter.badge_text }}</span>
              </div>

              {{ note.content }}

              <div class="note-meta">
                {{ note.presenter.source_label }}
              </div>
            </div>
          </div>

          <div class="inline">
            <a class="btn btn--soft" href="{{ url_for('notes.edit_note', note_id=note.id) }}">Edytuj</a>

            <form method="post" action="{{ url_for('notes.delete_note', note_id=note.id) }}"
                  onsubmit="return confirm('Na pewno usunÄ…Ä‡ notatkÄ™?');">
              <button class="btn danger" type="submit">UsuÅ„</button>
            </form>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="flash" style="margin-top:12px;">
      <div class="flash-dot"></div>
      <div class="flash-msg">Brak notatek. Dodaj pierwszÄ… powyÅ¼ej ðŸ‘†</div>
    </div>
  {% endif %}

  <div class="actions" style="margin-top: 16px;">
    <a class="btn btn--soft" href="{{ url_for('main.index') }}">Strona gÅ‚Ã³wna</a>
    <a class="btn btn--soft" href="{{ url_for('auth.logout') }}">Wyloguj</a>
  </div>
{% endblock %}